/*C2*/SET SCHEMA PUBLIC
CONNECT USER SA
drop table uf if exists cascade
\u000adrop table bairro if exists cascade
\u000adrop table cep if exists cascade
\u000adrop table municipio if exists cascade
\u000adrop table grupo if exists cascade
\u000adrop table pessoa if exists cascade
\u000adrop table pessoa_fisica if exists cascade
\u000adrop table pessoa_juridica if exists cascade
\u000adrop table meta if exists cascade
\u000adrop table movimento if exists cascade
\u000adrop table transportador if exists cascade
\u000adrop table comissao if exists cascade
\u000adrop table vendedor if exists cascade
\u000adrop table produto if exists cascade
\u000adrop table venda if exists cascade
\u000adrop table venda_item if exists cascade
\u000adrop table nota_fiscal if exists cascade
\u000adrop table outros_movimentos if exists cascade
\u000adrop table outros_movimentos_item if exists cascade
\u000adrop table marca if exists cascade
\u000a\u000acreate table uf (id integer GENERATED BY DEFAULT AS IDENTITY, ds_uf varchar(255),\u000aconstraint pk_uf primary key (id))
\u000a\u000acreate table bairro (id integer GENERATED BY DEFAULT AS IDENTITY, ds_bairro varchar(255),\u000aconstraint pk_bairro primary key (id))
\u000a\u000acreate table cep (id integer, nr_cpf varchar(20),\u000aconstraint pk_cep primary key (id))
\u000a\u000acreate table municipio (id integer GENERATED BY DEFAULT AS IDENTITY, ds_municipio varchar(255), cd_ibge varchar(10),\u000aconstraint pk_municipio primary key (id),\u000aconstraint un_municipio_ibge unique (cd_ibge))
\u000a\u000acreate table grupo(id integer GENERATED BY DEFAULT AS IDENTITY, ds_grupo varchar(255),\u000aconstraint pk_grupo primary key(id))
\u000acreate table marca(id integer, ds_marca varchar(255),\u000aconstraint pk_marca primary key(id))
\u000a\u000acreate table pessoa(id integer GENERATED BY DEFAULT AS IDENTITY, ds_nome varchar(255), ds_endereco varchar(255), nr_endereco varchar(7), id_bairro integer, \u000aid_municipio integer, id_uf integer, id_cep integer, nr_telefone varchar(12), ds_email varchar(255),\u000aconstraint pk_pessoa primary key (id),\u000aconstraint fk_pessoa_bairro foreign key (id_bairro) references bairro (id),\u000aconstraint fk_pessoa_municipio foreign key (id_municipio) references municipio (id),\u000aconstraint fk_pessoa_uf foreign key (id_uf) references uf (id),\u000aconstraint fk_pessoa_cep foreign key (id_cep) references cep(id))
\u000a\u000acreate table pessoa_fisica (id_pessoa integer, nr_cpf varchar(11), nr_rg varchar(10), sexo varchar(1), dt_nascimento date,\u000aconstraint pk_pessoa_fisica primary key (id_pessoa, nr_cpf),\u000aconstraint fk_pf_pessoa foreign key (id_pessoa) references pessoa (id),\u000aconstraint un_pf_cpf unique (nr_cpf),\u000aconstraint un_pf_rg unique (nr_rg),\u000aconstraint ck_pf_sexo check (sexo in('F','M')))
\u000a\u000acreate table pessoa_juridica (id_pessoa integer, nr_cnpj varchar(14), nr_ie varchar(10), nr_im varchar(9), nr_cnae varchar(10), ds_contribuinte varchar(1),\u000aconstraint pk_pessoa_juridica primary key (id_pessoa, nr_cnpj),\u000aconstraint fk_pj_pessoa foreign key (id_pessoa) references pessoa (id),\u000aconstraint ck_pj_contribuinte check (ds_contribuinte in('S','N')))
\u000a\u000acreate table meta(id integer GENERATED BY DEFAULT AS IDENTITY, ds_meta varchar(255), vl_meta integer, dt_inicio_vigencia date, dt_final_vigencia date,\u000aconstraint pk_meta primary key (id))
\u000a\u000acreate table movimento(id integer GENERATED BY DEFAULT AS IDENTITY, tipo integer, ds_movimento varchar(255),\u000aconstraint pk_movimento primary key (id))
\u000a\u000acreate table transportador(id integer GENERATED BY DEFAULT AS IDENTITY, ds_transportador varchar(255), ds_placa varchar(15),\u000aconstraint pk_transportador primary key (id))
\u000a\u000acreate table comissao(id integer GENERATED BY DEFAULT AS IDENTITY, vl_comissao numeric(15,2), dt_inicio_vigencia date, dt_final_vigencia date,\u000aconstraint pk_comissao primary key (id))
\u000a\u000acreate table vendedor(id integer GENERATED BY DEFAULT AS IDENTITY, id_pessoa integer, id_meta integer, id_comissao integer,\u000aconstraint pk_vendedor primary key (id),\u000aconstraint fk_vendedor_pessoa foreign key (id_pessoa) references pessoa (id),\u000aconstraint fk_vendedor_comissao foreign key (id_comissao) references comissao (id),\u000aconstraint fk_vendedor_meta foreign key (id_meta) references meta (id))
\u000a\u000acreate table produto(id integer GENERATED BY DEFAULT AS IDENTITY, ds_produto varchar(255), ds_referencia varchar(255), cod_barra varchar(30), id_marca integer,\u000aqt_estoque numeric(15,2), id_grupo integer, vl_custo numeric(15,2), vl_venda numeric(15,2), vl_prazo numeric(15,2), nr_ncm varchar(5), nr_cst varchar(5), tipo_venda numeric(3),\u000aconstraint pk_produto primary key (id),\u000aconstraint fk_produto_marca foreign key (id_marca) references marca (id),\u000aconstraint fk_produto_grupo foreign key (id_grupo) references grupo (id))
\u000a\u000acreate table venda(id integer GENERATED BY DEFAULT AS IDENTITY, ds_venda varchar(255), id_cliente integer, id_vendedor integer, tipo_pgto numeric(30),\u000avl_desconto numeric(15,2), vl_acrescimo numeric(15,2),\u000aconstraint pk_venda primary key (id),\u000aconstraint fk_venda_cliente foreign key (id_cliente) references pessoa (id),\u000aconstraint fk_venda_vendedor foreign key (id_vendedor) references vendedor (id))
\u000a\u000acreate table venda_item(id integer, id_venda integer, id_produto integer, qt_venda numeric(15,2),\u000aconstraint pk_venda_item primary key (id, id_venda),\u000aconstraint fk_venda foreign key (id_venda) references venda(id),\u000aconstraint fk_venda_produto foreign key (id_produto) references produto(id))
\u000a\u000acreate table nota_fiscal(id integer GENERATED BY DEFAULT AS IDENTITY, id_venda integer, nr_cfop varchar(10), id_transportador integer,\u000aconstraint pk_nf primary key (id),\u000aconstraint fk_nf_venda foreign key (id_venda) references venda(id),\u000aconstraint fk_nf_transportador foreign key (id_transportador) references transportador(id))
\u000a\u000acreate table outros_movimentos(id integer GENERATED BY DEFAULT AS IDENTITY, id_movimento integer, id_cliente integer, id_vendedor integer,\u000aconstraint pk_outros_movimentos primary key (id),\u000aconstraint fk_ouros_mov_cliente foreign key (id_cliente) references pessoa(id),\u000aconstraint fk_outros_mov_vendedor foreign key (id_vendedor) references vendedor(id))
\u000a\u000acreate table outros_movimentos_item(id integer GENERATED BY DEFAULT AS IDENTITY, id_outros_mov integer, id_produto integer, qt_movimento numeric(15,2),\u000aconstraint pk_outros_movimentos_item primary key (id),\u000aconstraint fk_ouros_movimentos_item foreign key (id_outros_mov) references outros_movimentos(id),\u000aconstraint fk_outros_mov_item_produto foreign key (id_produto) references produto(id))
DISCONNECT
